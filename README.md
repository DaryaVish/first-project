# Прогнозирование оттока клиентов.
Из «Бета-Банка» стали уходить клиенты. Каждый месяц. Немного, но заметно. Банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых.

Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. Вам предоставлены исторические данные о поведении клиентов и расторжении договоров с банком.

Постройте модель с предельно большим значением F1-меры. Чтобы сдать проект успешно, нужно довести метрику до 0.59. Проверьте F1-меру на тестовой выборке самостоятельно.

Дополнительно измеряйте AUC-ROC, сравнивайте её значение с F1-мерой.

Источник данных: https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling

Описание данных

Датафрейм содержит исторические данные о поведении клиентов и расторжении договоров с банком:

RowNumber — индекс строки в данных,

CustomerId — уникальный идентификатор клиента,

Surname — фамилия,

CreditScore — кредитный рейтинг,

Geography — страна проживания,

Gender — пол,

Age — возраст,

Tenure — сколько лет человек является клиентом банка,

Balance — баланс на счёте,

NumOfProducts — количество продуктов банка, используемых клиентом,

HasCrCard — наличие кредитной карты,

IsActiveMember — активность клиента,

EstimatedSalary — предполагаемая зарплата.

Целевой признак

Exited — факт ухода клиента

Вывод: 
Без баланса классов модель LogisticRegression находит лучше всего TN и FN. Почти все положительные ответы попадают в FN.

модель LogisticRegression f1 за счет баланса повысилась с 0.3 до 0.48;
после баланса модель стала стала лучше находить единицы, но начала путать нули: появилось очень много FP ответов, до баланса их было всего 55, а теперь 470. FN до баланса было 323, а после стало 137. TP до баланса было 88, а после 270;
среднегармоническое полноты и точности модели RF после баланса возросло с 0.56 до 0.61.
После работы над дисбалансом классов метрика f1 моделей возрасла. Я применила взвешивание классов для модели логистической регресии, для модели случайного леса лучший результат показала техника upsampling.

Для работы с тестовой выборкой были взяты модели с наилушим показателем f1 - RF после баланса. На тестовой выборке roc_auc: 0.85, f1 достигает 0.61.
